{% doc %}
  @prompt
    Product + video, with demo product and video, with equal width and height, using the theme tyle to format it and no space in between

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-product-video-{{ ai_gen_id }} {
    display: grid;
    gap: 0;
    max-width: 100%;
    border-radius: {{ settings.card_corner_radius }}px;
    overflow: hidden;
    {% if settings.card_style == 'card' %}
      background-color: rgba(var(--color-foreground), 0.04);
      border: {{ settings.card_border_thickness }}px solid rgba(var(--color-foreground), {{ settings.card_border_opacity | divided_by: 100.0 }});
      box-shadow: {{ settings.card_shadow_horizontal_offset }}px {{ settings.card_shadow_vertical_offset }}px {{ settings.card_shadow_blur }}px rgba(var(--color-shadow), {{ settings.card_shadow_opacity | divided_by: 100.0 }});
    {% endif %}
  }

  .ai-product-video-{{ ai_gen_id }}--layout-side-by-side {
    grid-template-columns: 1fr 1fr;
    align-items: stretch;
  }

  .ai-product-video-{{ ai_gen_id }}--layout-stacked {
    grid-template-columns: 1fr;
  }

  .ai-product-video-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    background-color: rgba(var(--color-foreground), 0.04);
    overflow: hidden;
  }

  .ai-product-video-wrapper-{{ ai_gen_id }} video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-product-video-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .ai-product-video-placeholder-{{ ai_gen_id }} svg {
    width: 80px;
    height: 80px;
    color: white;
    opacity: 0.8;
  }

  .ai-product-video-empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.4rem;
    color: white;
    text-align: center;
    pointer-events: none;
    opacity: 0.9;
  }

  .ai-product-content-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    padding: {{ settings.spacing_grid_vertical }}px {{ settings.spacing_grid_horizontal }}px;
    height: 100%;
    {% if settings.card_style == 'card' %}
      background-color: rgb(var(--color-background));
    {% endif %}
  }

  .ai-product-image-{{ ai_gen_id }} {
    width: 100%;
    aspect-ratio: 1;
    object-fit: cover;
    border-radius: {{ settings.media_radius }}px;
    border: {{ settings.media_border_thickness }}px solid rgba(var(--color-foreground), {{ settings.media_border_opacity | divided_by: 100.0 }});
    {% if settings.media_shadow_opacity > 0 %}
      box-shadow: {{ settings.media_shadow_horizontal_offset }}px {{ settings.media_shadow_vertical_offset }}px {{ settings.media_shadow_blur }}px rgba(var(--color-shadow), {{ settings.media_shadow_opacity | divided_by: 100.0 }});
    {% endif %}
  }

  .ai-product-image-placeholder-{{ ai_gen_id }} {
    width: 100%;
    aspect-ratio: 1;
    background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
    border-radius: {{ settings.media_radius }}px;
    border: {{ settings.media_border_thickness }}px solid rgba(var(--color-foreground), {{ settings.media_border_opacity | divided_by: 100.0 }});
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    {% if settings.media_shadow_opacity > 0 %}
      box-shadow: {{ settings.media_shadow_horizontal_offset }}px {{ settings.media_shadow_vertical_offset }}px {{ settings.media_shadow_blur }}px rgba(var(--color-shadow), {{ settings.media_shadow_opacity | divided_by: 100.0 }});
    {% endif %}
  }

  .ai-product-image-placeholder-{{ ai_gen_id }} svg {
    width: 60px;
    height: 60px;
    color: white;
    opacity: 0.8;
  }

  .ai-product-info-{{ ai_gen_id }} {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    margin-top: 1.6rem;
  }

  .ai-product-title-{{ ai_gen_id }} {
    font-family: var(--font-heading-family);
    font-style: var(--font-heading-style);
    font-weight: var(--font-heading-weight);
    font-size: calc(var(--font-heading-scale) * 2.4rem);
    color: rgb(var(--color-foreground));
    margin: 0;
    line-height: calc(1+ 0.3 / var(--font-body-scale));
    text-align: {{ settings.card_text_alignment }};
  }

  .ai-product-price-{{ ai_gen_id }} {
    font-size: calc(var(--font-body-scale) * 1.8rem);
    color: rgb(var(--color-foreground));
    font-weight: 500;
    text-align: {{ settings.card_text_alignment }};
  }

  .ai-product-description-{{ ai_gen_id }} {
    font-size: calc(var(--font-body-scale) * 1.4rem);
    color: rgba(var(--color-foreground), 0.75);
    line-height: calc(1 + 0.8 / var(--font-body-scale));
    flex-grow: 1;
    text-align: {{ settings.card_text_alignment }};
  }

  .ai-product-button-{{ ai_gen_id }} {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 1.2rem 2.4rem;
    background-color: rgb(var(--color-button));
    color: rgb(var(--color-button-text));
    text-decoration: none;
    border-radius: {{ settings.buttons_radius }}px;
    border: {{ settings.buttons_border_thickness }}px solid rgba(var(--color-button), {{ settings.buttons_border_opacity | divided_by: 100.0 }});
    font-weight: 500;
    transition: all 0.3s ease;
    cursor: pointer;
    font-size: calc(var(--font-body-scale) * 1.4rem);
    margin-top: auto;
    {% if settings.buttons_shadow_opacity > 0 %}
      box-shadow: {{ settings.buttons_shadow_horizontal_offset }}px {{ settings.buttons_shadow_vertical_offset }}px {{ settings.buttons_shadow_blur }}px rgba(var(--color-shadow), {{ settings.buttons_shadow_opacity | divided_by: 100.0 }});
    {% endif %}
    {% if settings.card_text_alignment == 'center' %}
      align-self: center;
    {% elsif settings.card_text_alignment == 'right' %}
      align-self: flex-end;
    {% else %}
      align-self: flex-start;
    {% endif %}
  }

  .ai-product-button-{{ ai_gen_id }}:hover {
    background-color: rgba(var(--color-button), 0.85);
    transform: translateY(-1px);
  }

  .ai-demo-badge-{{ ai_gen_id }} {
    display: inline-block;
    background-color: rgb(var(--color-button));
    color: rgb(var(--color-button-text));
    padding: 0.4rem 0.8rem;
    border-radius: {{ settings.badge_corner_radius }}px;
    font-size: 1.2rem;
    font-weight: 500;
    margin-bottom: 0.8rem;
    width: fit-content;
    {% if settings.card_text_alignment == 'center' %}
      align-self: center;
    {% elsif settings.card_text_alignment == 'right' %}
      align-self: flex-end;
    {% else %}
      align-self: flex-start;
    {% endif %}
  }

  @media screen and (max-width: 749px) {
    .ai-product-video-{{ ai_gen_id }}--layout-side-by-side {
      grid-template-columns: 1fr;
    }

    .ai-product-title-{{ ai_gen_id }} {
      font-size: calc(var(--font-heading-scale) * 2rem);
    }

    .ai-product-price-{{ ai_gen_id }} {
      font-size: calc(var(--font-body-scale) * 1.6rem);
    }

    .ai-product-description-{{ ai_gen_id }} {
      font-size: calc(var(--font-body-scale) * 1.3rem);
    }

    .ai-product-button-{{ ai_gen_id }} {
      font-size: calc(var(--font-body-scale) * 1.3rem);
      padding: 1rem 2rem;
    }
  }
{% endstyle %}

<div 
  class="ai-product-video-{{ ai_gen_id }} ai-product-video-{{ ai_gen_id }}--layout-{{ block.settings.layout }} color-{{ block.settings.color_scheme }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-product-video-wrapper-{{ ai_gen_id }}">
    {% if block.settings.video %}
      <video 
        controls
        {% if block.settings.autoplay %}autoplay{% endif %}
        {% if block.settings.muted %}muted{% endif %}
        {% if block.settings.loop %}loop{% endif %}
        preload="metadata"
      >
        <source src="{{ block.settings.video }}" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    {% else %}
      <div class="ai-product-video-placeholder-{{ ai_gen_id }}">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="5,3 19,12 5,21"></polygon>
        </svg>
        <div class="ai-product-video-empty-state-{{ ai_gen_id }}">
          Demo Product Video
        </div>
      </div>
    {% endif %}
  </div>

  <div class="ai-product-content-{{ ai_gen_id }}">
    {% if block.settings.product %}
      {% if block.settings.show_product_image and block.settings.product.featured_image %}
        <img
          src="{{ block.settings.product.featured_image | image_url: width: 600}}"
          alt="{{ block.settings.product.featured_image.alt | escape }}"
          class="ai-product-image-{{ ai_gen_id }}"
          loading="lazy"
          width="600"
          height="600"
        >
      {% elsif block.settings.show_product_image %}
        <div class="ai-product-image-placeholder-{{ ai_gen_id }}">
          {{'product-1' | placeholder_svg_tag }}
        </div>
      {% endif %}

      <div class="ai-product-info-{{ ai_gen_id }}">
        <h3 class="ai-product-title-{{ ai_gen_id }}">{{ block.settings.product.title }}</h3>
        <div class="ai-product-price-{{ ai_gen_id }}">
          {% if block.settings.product.compare_at_price > block.settings.product.price %}
            <span style="text-decoration: line-through; opacity: 0.7;">{{ block.settings.product.compare_at_price | money }}</span>
          {% endif %}
          {{ block.settings.product.price | money }}
        </div>

        {% if block.settings.show_description and block.settings.product.description != blank %}
          <div class="ai-product-description-{{ ai_gen_id }}">
            {{ block.settings.product.description | truncate: 150 }}
          </div>
        {% endif %}

        <a href="{{ block.settings.product.url }}" class="ai-product-button-{{ ai_gen_id }}">
          {{ block.settings.button_text }}
        </a>
      </div>
    {% else %}
      <div class="ai-demo-badge-{{ ai_gen_id }}">DEMO</div>
      
      {% if block.settings.show_product_image %}
        <div class="ai-product-image-placeholder-{{ ai_gen_id }}">
          {{'product-1' | placeholder_svg_tag }}
        </div>
      {% endif %}

      <div class="ai-product-info-{{ ai_gen_id }}">
        <h3 class="ai-product-title-{{ ai_gen_id }}">Premium Wireless Headphones</h3>
        <div class="ai-product-price-{{ ai_gen_id }}">
          <span style="text-decoration: line-through; opacity: 0.7;">$199.99</span>
          $149.99
        </div>

        {% if block.settings.show_description %}
          <div class="ai-product-description-{{ ai_gen_id }}">
            Experience crystal-clear audio with our premium wireless headphones. Featuring noise cancellation, 30-hour battery life, and premium comfort.
          </div>
        {% endif %}

        <a href="#" class="ai-product-button-{{ ai_gen_id }}">
          {{ block.settings.button_text }}
        </a>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Product + video",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "side-by-side",
          "label": "Side by side"
        },
        {
          "value": "stacked",
          "label": "Stacked"
        }
      ],
      "default": "side-by-side"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Video"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "muted",
      "label": "Muted",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Loop",
      "default": false
    },
    {
      "type": "header",
      "content": "Product"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "checkbox",
      "id": "show_product_image",
      "label": "Show product image",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show description",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop now"
    }
  ],
  "presets": [
    {
      "name": "Product + video"
    }
  ],
  "tag": null
}
{% endschema %}