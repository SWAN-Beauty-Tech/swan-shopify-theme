{% doc %}
  @prompt
    Generate a banner section where 10 different curated brands are shown and slowly sliding from right to left through the screen. 
    I would like to have the possibility to upload 10 different brand icons and chose the logo sizes ., The carusel should be endless, meaning that when the last brand is shown, the first one appears again

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-brand-banner-{{ ai_gen_id }} {
    width: 100%;
    overflow: hidden;
    background-color: {{ block.settings.background_color }};
    padding: {{ block.settings.section_padding }}px 0;
  }

  .ai-brand-banner-track-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: {{ block.settings.logo_spacing }}px;
    width: max-content;
  }

  .ai-brand-banner-set-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: {{ block.settings.logo_spacing }}px;
    animation: ai-brand-banner-scroll-{{ ai_gen_id }} {{ block.settings.animation_speed }}s linear infinite;
  }

  .ai-brand-banner-item-{{ ai_gen_id }} {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: {{ block.settings.logo_size }}px;
    height: {{ block.settings.logo_size }}px;
  }

  .ai-brand-banner-item-{{ ai_gen_id }} img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    filter: grayscale({{ block.settings.grayscale_amount }}%);
    opacity: {{ block.settings.logo_opacity | divided_by: 100.0 }};
    transition: filter 0.3s ease, opacity 0.3s ease;
  }

  .ai-brand-banner-item-{{ ai_gen_id }}:hover img {
    filter: grayscale(0%);
    opacity: 1;
  }

  .ai-brand-banner-placeholder-{{ ai_gen_id }} {
    width: {{ block.settings.logo_size }}px;
    height: {{ block.settings.logo_size }}px;
    background-color: #f4f4f4;
    border: 2px dashed #cccccc;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .ai-brand-banner-placeholder-{{ ai_gen_id }} svg {
    width: 50%;
    height: 50%;
    opacity: 0.5;
  }

  .ai-brand-banner-empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 12px;
    color: #666;
    text-align: center;
    white-space: nowrap;
    pointer-events: none;
  }

  @keyframes ai-brand-banner-scroll-{{ ai_gen_id }} {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(calc(-100% - {{ block.settings.logo_spacing }}px));
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .ai-brand-banner-set-{{ ai_gen_id }} {
      animation: none;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-brand-banner-item-{{ ai_gen_id }} {
      width: {{ block.settings.logo_size | times: 0.8 }}px;
      height: {{ block.settings.logo_size | times: 0.8 }}px;
    }

    .ai-brand-banner-placeholder-{{ ai_gen_id }} {
      width: {{ block.settings.logo_size | times: 0.8 }}px;
      height: {{ block.settings.logo_size | times: 0.8 }}px;
    }
  }
{% endstyle %}

<brand-banner-{{ ai_gen_id }}
  class="ai-brand-banner-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-brand-banner-track-{{ ai_gen_id }}">
    {% liquid
      assign logos_array = ''
      for i in (1..10)
        assign logo_key = 'brand_logo_' | append: i
        assign logo = block.settings[logo_key]
        if logo != blank
          assign logos_array = logos_array | append: logo.id | append: ','
        endif
      endfor
      assign logos_array = logos_array | remove_last: ','
      assign logos_count = logos_array | split: ',' | size
    %}

    {% for duplicate in (1..3) %}
      <div class="ai-brand-banner-set-{{ ai_gen_id }}">
        {% if logos_count > 0 %}
          {% for i in (1..10) %}
            {% liquid
              assign logo_key = 'brand_logo_' | append: i
              assign logo = block.settings[logo_key]
            %}
            {% if logo != blank %}
              <div class="ai-brand-banner-item-{{ ai_gen_id }}">
                <img
                  src="{{ logo | image_url: width: 400 }}"
                  alt="{{ logo.alt | escape }}"
                  loading="lazy"
                  width="{{ block.settings.logo_size }}"
                  height="{{ block.settings.logo_size }}"
                >
              </div>
            {% endif %}
          {% endfor %}
        {% else %}
          {% for i in (1..10) %}
            <div class="ai-brand-banner-item-{{ ai_gen_id }}">
              <div class="ai-brand-banner-placeholder-{{ ai_gen_id }}">
                {{ 'image' | placeholder_svg_tag }}
                <div class="ai-brand-banner-empty-state-{{ ai_gen_id }}">
                  Brand {{ i }}
                </div>
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>
    {% endfor %}
  </div>
</brand-banner-{{ ai_gen_id }}>

<script>
  (function() {
    class BrandBanner{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.track = this.querySelector('.ai-brand-banner-track-{{ ai_gen_id }}');
        this.sets = this.querySelectorAll('.ai-brand-banner-set-{{ ai_gen_id }}');
        this.setupEndlessScroll();
      }

      setupEndlessScroll() {
        if (!this.track || this.sets.length === 0) return;

        this.sets.forEach((set, index) => {
          set.style.animationDelay = `${index * -{{ block.settings.animation_speed | divided_by: 3.0 }}}s`;
        });
      }
    }

    customElements.define('brand-banner-{{ ai_gen_id }}', BrandBanner{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Brand banner",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "logo_size",
      "min": 60,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Logo size",
      "default": 120
    },
    {
      "type": "range",
      "id": "logo_spacing",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Logo spacing",
      "default": 60
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Section padding",
      "default": 40
    },
    {
      "type": "header",
      "content": "Animation"
    },
    {
      "type": "range",
      "id": "animation_speed",
      "min": 15,
      "max": 60,
      "step": 5,
      "unit": "s",
      "label": "Animation speed",
      "default": 30
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "logo_opacity",
      "min": 30,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "Logo opacity",
      "default": 70
    },
    {
      "type": "range",
      "id": "grayscale_amount",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "Grayscale amount",
      "default": 100
    },
    {
      "type": "header",
      "content": "Brand logos"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_1",
      "label": "Brand logo 1"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_2",
      "label": "Brand logo 2"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_3",
      "label": "Brand logo 3"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_4",
      "label": "Brand logo 4"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_5",
      "label": "Brand logo 5"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_6",
      "label": "Brand logo 6"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_7",
      "label": "Brand logo 7"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_8",
      "label": "Brand logo 8"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_9",
      "label": "Brand logo 9"
    },
    {
      "type": "image_picker",
      "id": "brand_logo_10",
      "label": "Brand logo 10"
    }
  ],
  "presets": [
    {
      "name": "Brand banner"
    }
  ],
  "tag": null
}
{% endschema %}